:root{
  --bg:#E63E62;      /* cherry-rose primary */
  --card:#8F2A46;    /* deep plum for cards */
  --line:#6E1F36;    /* borders */
  --muted:#FFD5E1;   /* hints */
  --ink:#000000;     /* one-ink for tag/icons */
  --btn:#6B1631;     /* buttons */
  --btnHover:#5A1229;
  --fg:#FFFFFF;      /* text */
}

/* Base */
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--fg);font:16px/1.5 system-ui,Segoe UI,Roboto,Helvetica,Arial}
.wrap{max-width:900px;margin:0 auto;padding:16px}
.card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:12px;margin:12px 0}
h1{font-size:20px;margin:6px 0 6px}
p.lead{margin:0;color:var(--fg);opacity:.9;font-size:14px}

button,select,input,a.btn{
  padding:12px;border-radius:12px;border:1px solid var(--line);
  background:rgba(0,0,0,.18);color:var(--fg);font-size:15px;height:46px
}
button{background:var(--btn);border:none;font-weight:700;cursor:pointer}
button:hover{background:var(--btnHover)}
button.ghost{background:transparent;border:1px solid var(--line)}
.inline{display:flex;gap:10px;align-items:center}
.actions{display:flex;gap:10px;justify-content:space-between;margin-top:6px}
.tiny{font-size:12px;color:var(--muted)}
.mono{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
select{ line-height:1; } /* piccola correzione per la select */

/* Timeline */
.timeline{position:relative}
.rail{position:absolute;left:50%;width:2px;background:var(--fg);opacity:.35;z-index:0;pointer-events:none}
.step{position:relative;display:flex;flex-direction:column;gap:10px;padding:12px;border:1px solid var(--line);border-radius:12px;background:var(--card);margin:14px 0;z-index:1;transition:transform .18s ease;background-clip:padding-box}
.step.fixed{background:#7B2840}
label{font-weight:600;font-size:14px;white-space:nowrap}
.row{display:flex;flex-direction:column;gap:8px}
.grid2{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px}
.square{width:42px;min-width:42px;height:42px;display:grid;place-items:center;padding:0}
.trash{width:18px;height:18px;fill:var(--fg);opacity:.9}

/* Step controls */
.step .close{
  position:absolute;top:8px;right:8px;width:26px;height:26px;border-radius:8px;
  border:1px solid var(--line);background:rgba(0,0,0,.18);
  display:grid;place-items:center;cursor:pointer
}
.step .close:hover{background:var(--btnHover)}

/* Riga numero | select | maniglia */
.step .inline{
  display:grid;
  grid-template-columns:auto 1fr 34px;
  align-items:center;
  gap:10px;
}
.step .num, .step .mono{
  height:46px;display:flex;align-items:center;
  padding:0 6px 0 2px !important; /* forza eventuale padding inline */
  font-weight:700;
}

/* Maniglia */
.handle{
  width:34px;height:46px;display:grid;place-items:center;
  color:var(--fg);cursor:grab;user-select:none;touch-action:none;
  background:transparent;border:none;
}
.handle:active{cursor:grabbing}
.dots{height:22px;opacity:.9;margin-top:0}

/* X (chiudi) con pseudo-elementi, centrata */
.xbtn{
  position:absolute;right:-8px;top:-12px;width:28px;height:28px;border-radius:50%;
  border:1px solid var(--line);background:rgba(0,0,0,.18);color:var(--fg);
  display:block;cursor:pointer;padding:0;line-height:0;font-size:0
}
.xbtn:hover{ background:var(--btnHover); }
.xbtn::before,.xbtn::after{
  content:"";position:absolute;left:50%;top:50%;width:14px;height:2px;background:currentColor;
  transform-origin:center;border-radius:2px
}
.xbtn::before{transform:translate(-50%,-50%) rotate(45deg)}
.xbtn::after{transform:translate(-50%,-50%) rotate(-45deg)}
@media (min-width:768px){
  .xbtn{width:24px;height:24px}
  .xbtn::before,.xbtn::after{width:10px}
}

/* Ghost durante drag */
.step.drag-ghost{opacity:.9;box-shadow:0 8px 24px rgba(0,0,0,.25);z-index:99}

/* BeanTag — titolo sopra e box sotto; nascosto finché non è .open */
#beanPanel{display:none}
#beanPanel.open{display:flex;flex-direction:column;gap:8px}
.bean-title{font-size:16px;font-weight:700;white-space:nowrap}
.bean{
  width:100%;display:flex;justify-content:center;align-items:center;
  padding:8px;background:#FFE7EE;border:1px dashed var(--line);border-radius:12px
}
canvas#beanCanvas{width:min(64vw,260px);height:auto;background:#FFFFFF;border-radius:10px}

/* CPC: titolo sopra e box codice sotto a tutta larghezza */
.cpc-row{
  display:flex;flex-direction:column;gap:8px;align-items:stretch
}
.cpc-row > b{font-size:16px;font-weight:700;white-space:nowrap}

#cpcWrap{position:relative;width:100%}
#cpc{
  display:flex;align-items:center;
  line-height:1.3;
  padding:10px 44px 10px 12px;  /* spazio per l’icona a destra */
  background:rgba(0,0,0,.18);
  border:1px solid var(--line);
  border-radius:8px;
  min-height:46px;             /* coerente coi bottoni */
  overflow:auto;word-break:break-all
}
#copyIcon{
  position:absolute;right:6px;top:50%;transform:translateY(-50%);
  width:32px;height:32px;border:1px solid var(--line);border-radius:8px;
  background:transparent;display:grid;place-items:center;cursor:pointer
}
#copyIcon svg{width:18px;height:18px;fill:currentColor}

/* Download menu */
.icon-btn{display:inline-flex;align-items:center;gap:8px}
.caret{margin-left:6px;border:solid var(--fg);border-width:0 2px 2px 0;display:inline-block;padding:3px;transform:rotate(45deg)}
.menu{position:relative;display:inline-block;width:100%}
.menu .menu-trigger{width:100%;justify-content:center;display:flex;align-items:center;gap:8px}
.caret{margin-left:6px;border:solid var(--fg);border-width:0 2px 2px 0;display:inline-block;padding:4px;transform:rotate(45deg);transition:transform .15s ease}
.menu.open .caret{transform:rotate(-135deg)}
.menu-list{
  position:absolute;top:calc(100% + 6px);right:0;background:var(--card);
  border:1px solid var(--line);border-radius:10px;min-width:160px;display:none;z-index:10
}
.menu.open .menu-list{display:block}
.menu-list a{display:block;padding:10px 14px;color:var(--fg);text-decoration:none;border-bottom:1px solid var(--line)}
.menu-list a:last-child{border-bottom:none}
.menu-list a:hover{background:var(--btnHover)}

/* Pulsanti quadrati piccoli (se usi ancora .square) */
.square{width:42px;min-width:42px;height:42px;display:grid;place-items:center;padding:0}
.trash{width:18px;height:18px;fill:var(--fg);opacity:.9}

/* Riga 50/50 per Open link e Download */
.split-2{
  display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:8px
}
.split-2 .btn{
  display:block;width:100%;height:46px;font-weight:800;font-size:16px;border-radius:14px;text-align:center
}
.split-2 .menu{width:100%}
.split-2 .menu .menu-trigger{width:100%;height:46px;font-weight:800;font-size:16px;border-radius:14px}

/* Summary page */
#summary{list-style:none;margin:0;padding:0}
.sum-row{display:grid;grid-template-columns:40px 1fr;align-items:start;gap:10px;padding:6px 0;border-bottom:1px dashed var(--line)}
.sum-code{font-weight:700;letter-spacing:.5px}
.sum-title{display:flex;align-items:center;gap:8px;cursor:pointer}
.caret-small{width:8px;height:8px;border:solid var(--fg);border-width:0 2px 2px 0;display:inline-block;transform:rotate(-45deg);transition:.15s transform}
details[open] .caret-small{transform:rotate(45deg)}
details summary{list-style:none}
details summary::-webkit-details-marker{display:none}
.sum-desc{font-size:12px;opacity:.9;margin:6px 0 0 18px}

/* Home */
.home-cta{display:grid;grid-template-columns:1fr;gap:12px}
.home-cta a{display:block;text-align:center;text-decoration:none;background:var(--btn);border:none;color:var(--fg);font-weight:800;padding:18px;border-radius:14px}
.home-cta a:hover{background:var(--btnHover)}
